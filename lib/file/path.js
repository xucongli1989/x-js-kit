"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getFileName = getFileName;
exports.getFileNameWithoutExt = getFileNameWithoutExt;
exports.getExt = getExt;
exports.getExtWithoutDot = getExtWithoutDot;
exports.isSystemRecyclePath = isSystemRecyclePath;
exports.isOfficeTempPath = isOfficeTempPath;

/**
 * 获取文件名（包含扩展名），如：c:\1\2\3.txt => 3.txt
 */
function getFileName(path) {
  if (!path) {
    return "";
  }

  var str = path.replace(/\//g, "\\");
  var splitIndex = str.lastIndexOf("\\");

  if (splitIndex < 0) {
    return path.trim();
  }

  return str.substr(splitIndex + 1).trim();
}
/**
 * 获取文件名（不包含扩展名），如：c:\1\2\3.txt => 3
 */


function getFileNameWithoutExt(path) {
  var fileName = getFileName(path);

  if (!fileName) {
    return "";
  }

  var dotIndex = fileName.lastIndexOf(".");

  if (dotIndex < 0) {
    return fileName;
  }

  return fileName.substr(0, dotIndex);
}
/**
 * 获取扩展名（包含点）
 */


function getExt(path) {
  var fileName = getFileName(path);

  if (!fileName) {
    return "";
  }

  var dotIndex = fileName.lastIndexOf(".");

  if (dotIndex < 0) {
    return "";
  }

  return fileName.substr(dotIndex);
}
/**
 * 获取扩展名（不包含点）
 */


function getExtWithoutDot(path) {
  var fileName = getFileName(path);

  if (!fileName) {
    return "";
  }

  var dotIndex = fileName.lastIndexOf(".");

  if (dotIndex < 0) {
    return "";
  }

  return fileName.substr(dotIndex + 1);
}
/**
 * 判断一个路径是否为系统回收站的路径
 */


function isSystemRecyclePath(p) {
  if (!p) {
    return false;
  }

  return p.toUpperCase().includes("$RECYCLE.BIN");
}
/**
 * 判断一个路径是否为 Office 临时文件的路径（文件名以 ~$ 开头）
 */


function isOfficeTempPath(p) {
  if (!p) {
    return false;
  }

  return getFileName(p).startsWith("~$");
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9maWxlL3BhdGgudHMiXSwibmFtZXMiOlsiZ2V0RmlsZU5hbWUiLCJwYXRoIiwic3RyIiwicmVwbGFjZSIsInNwbGl0SW5kZXgiLCJsYXN0SW5kZXhPZiIsInRyaW0iLCJzdWJzdHIiLCJnZXRGaWxlTmFtZVdpdGhvdXRFeHQiLCJmaWxlTmFtZSIsImRvdEluZGV4IiwiZ2V0RXh0IiwiZ2V0RXh0V2l0aG91dERvdCIsImlzU3lzdGVtUmVjeWNsZVBhdGgiLCJwIiwidG9VcHBlckNhc2UiLCJpbmNsdWRlcyIsImlzT2ZmaWNlVGVtcFBhdGgiLCJzdGFydHNXaXRoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDTyxTQUFTQSxXQUFULENBQXFCQyxJQUFyQixFQUEyQztBQUM5QyxNQUFJLENBQUNBLElBQUwsRUFBVztBQUNQLFdBQU8sRUFBUDtBQUNIOztBQUNELE1BQU1DLEdBQUcsR0FBR0QsSUFBSSxDQUFDRSxPQUFMLENBQWEsS0FBYixFQUFvQixJQUFwQixDQUFaO0FBQ0EsTUFBTUMsVUFBVSxHQUFHRixHQUFHLENBQUNHLFdBQUosQ0FBZ0IsSUFBaEIsQ0FBbkI7O0FBQ0EsTUFBSUQsVUFBVSxHQUFHLENBQWpCLEVBQW9CO0FBQ2hCLFdBQU9ILElBQUksQ0FBQ0ssSUFBTCxFQUFQO0FBQ0g7O0FBQ0QsU0FBT0osR0FBRyxDQUFDSyxNQUFKLENBQVdILFVBQVUsR0FBRyxDQUF4QixFQUEyQkUsSUFBM0IsRUFBUDtBQUNIO0FBRUQ7QUFDQTtBQUNBOzs7QUFDTyxTQUFTRSxxQkFBVCxDQUErQlAsSUFBL0IsRUFBcUQ7QUFDeEQsTUFBTVEsUUFBUSxHQUFHVCxXQUFXLENBQUNDLElBQUQsQ0FBNUI7O0FBQ0EsTUFBSSxDQUFDUSxRQUFMLEVBQWU7QUFDWCxXQUFPLEVBQVA7QUFDSDs7QUFDRCxNQUFNQyxRQUFRLEdBQUdELFFBQVEsQ0FBQ0osV0FBVCxDQUFxQixHQUFyQixDQUFqQjs7QUFDQSxNQUFJSyxRQUFRLEdBQUcsQ0FBZixFQUFrQjtBQUNkLFdBQU9ELFFBQVA7QUFDSDs7QUFDRCxTQUFPQSxRQUFRLENBQUNGLE1BQVQsQ0FBZ0IsQ0FBaEIsRUFBbUJHLFFBQW5CLENBQVA7QUFDSDtBQUVEO0FBQ0E7QUFDQTs7O0FBQ08sU0FBU0MsTUFBVCxDQUFnQlYsSUFBaEIsRUFBc0M7QUFDekMsTUFBTVEsUUFBUSxHQUFHVCxXQUFXLENBQUNDLElBQUQsQ0FBNUI7O0FBQ0EsTUFBSSxDQUFDUSxRQUFMLEVBQWU7QUFDWCxXQUFPLEVBQVA7QUFDSDs7QUFDRCxNQUFNQyxRQUFRLEdBQUdELFFBQVEsQ0FBQ0osV0FBVCxDQUFxQixHQUFyQixDQUFqQjs7QUFDQSxNQUFJSyxRQUFRLEdBQUcsQ0FBZixFQUFrQjtBQUNkLFdBQU8sRUFBUDtBQUNIOztBQUNELFNBQU9ELFFBQVEsQ0FBQ0YsTUFBVCxDQUFnQkcsUUFBaEIsQ0FBUDtBQUNIO0FBRUQ7QUFDQTtBQUNBOzs7QUFDTyxTQUFTRSxnQkFBVCxDQUEwQlgsSUFBMUIsRUFBZ0Q7QUFDbkQsTUFBTVEsUUFBUSxHQUFHVCxXQUFXLENBQUNDLElBQUQsQ0FBNUI7O0FBQ0EsTUFBSSxDQUFDUSxRQUFMLEVBQWU7QUFDWCxXQUFPLEVBQVA7QUFDSDs7QUFDRCxNQUFNQyxRQUFRLEdBQUdELFFBQVEsQ0FBQ0osV0FBVCxDQUFxQixHQUFyQixDQUFqQjs7QUFDQSxNQUFJSyxRQUFRLEdBQUcsQ0FBZixFQUFrQjtBQUNkLFdBQU8sRUFBUDtBQUNIOztBQUNELFNBQU9ELFFBQVEsQ0FBQ0YsTUFBVCxDQUFnQkcsUUFBUSxHQUFHLENBQTNCLENBQVA7QUFDSDtBQUVEO0FBQ0E7QUFDQTs7O0FBQ08sU0FBU0csbUJBQVQsQ0FBNkJDLENBQTdCLEVBQXdDO0FBQzNDLE1BQUksQ0FBQ0EsQ0FBTCxFQUFRO0FBQ0osV0FBTyxLQUFQO0FBQ0g7O0FBQ0QsU0FBT0EsQ0FBQyxDQUFDQyxXQUFGLEdBQWdCQyxRQUFoQixDQUF5QixjQUF6QixDQUFQO0FBQ0g7QUFFRDtBQUNBO0FBQ0E7OztBQUNPLFNBQVNDLGdCQUFULENBQTBCSCxDQUExQixFQUFxQztBQUN4QyxNQUFJLENBQUNBLENBQUwsRUFBUTtBQUNKLFdBQU8sS0FBUDtBQUNIOztBQUNELFNBQU9kLFdBQVcsQ0FBQ2MsQ0FBRCxDQUFYLENBQWVJLFVBQWYsQ0FBMEIsSUFBMUIsQ0FBUDtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIOiOt+WPluaWh+S7tuWQje+8iOWMheWQq+aJqeWxleWQje+8ie+8jOWmgu+8mmM6XFwxXFwyXFwzLnR4dCA9PiAzLnR4dFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVOYW1lKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBpZiAoIXBhdGgpIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG4gICAgY29uc3Qgc3RyID0gcGF0aC5yZXBsYWNlKC9cXC8vZywgXCJcXFxcXCIpXHJcbiAgICBjb25zdCBzcGxpdEluZGV4ID0gc3RyLmxhc3RJbmRleE9mKFwiXFxcXFwiKVxyXG4gICAgaWYgKHNwbGl0SW5kZXggPCAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdGgudHJpbSgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RyLnN1YnN0cihzcGxpdEluZGV4ICsgMSkudHJpbSgpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDojrflj5bmlofku7blkI3vvIjkuI3ljIXlkKvmianlsZXlkI3vvInvvIzlpoLvvJpjOlxcMVxcMlxcMy50eHQgPT4gM1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVOYW1lV2l0aG91dEV4dChwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBnZXRGaWxlTmFtZShwYXRoKVxyXG4gICAgaWYgKCFmaWxlTmFtZSkge1xyXG4gICAgICAgIHJldHVybiBcIlwiXHJcbiAgICB9XHJcbiAgICBjb25zdCBkb3RJbmRleCA9IGZpbGVOYW1lLmxhc3RJbmRleE9mKFwiLlwiKVxyXG4gICAgaWYgKGRvdEluZGV4IDwgMCkge1xyXG4gICAgICAgIHJldHVybiBmaWxlTmFtZVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpbGVOYW1lLnN1YnN0cigwLCBkb3RJbmRleClcclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPluaJqeWxleWQje+8iOWMheWQq+eCue+8iVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEV4dChwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBnZXRGaWxlTmFtZShwYXRoKVxyXG4gICAgaWYgKCFmaWxlTmFtZSkge1xyXG4gICAgICAgIHJldHVybiBcIlwiXHJcbiAgICB9XHJcbiAgICBjb25zdCBkb3RJbmRleCA9IGZpbGVOYW1lLmxhc3RJbmRleE9mKFwiLlwiKVxyXG4gICAgaWYgKGRvdEluZGV4IDwgMCkge1xyXG4gICAgICAgIHJldHVybiBcIlwiXHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmlsZU5hbWUuc3Vic3RyKGRvdEluZGV4KVxyXG59XHJcblxyXG4vKipcclxuICog6I635Y+W5omp5bGV5ZCN77yI5LiN5YyF5ZCr54K577yJXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXh0V2l0aG91dERvdChwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgZmlsZU5hbWUgPSBnZXRGaWxlTmFtZShwYXRoKVxyXG4gICAgaWYgKCFmaWxlTmFtZSkge1xyXG4gICAgICAgIHJldHVybiBcIlwiXHJcbiAgICB9XHJcbiAgICBjb25zdCBkb3RJbmRleCA9IGZpbGVOYW1lLmxhc3RJbmRleE9mKFwiLlwiKVxyXG4gICAgaWYgKGRvdEluZGV4IDwgMCkge1xyXG4gICAgICAgIHJldHVybiBcIlwiXHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmlsZU5hbWUuc3Vic3RyKGRvdEluZGV4ICsgMSlcclxufVxyXG5cclxuLyoqXHJcbiAqIOWIpOaWreS4gOS4qui3r+W+hOaYr+WQpuS4uuezu+e7n+WbnuaUtuermeeahOi3r+W+hFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzU3lzdGVtUmVjeWNsZVBhdGgocDogc3RyaW5nKSB7XHJcbiAgICBpZiAoIXApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICAgIHJldHVybiBwLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoXCIkUkVDWUNMRS5CSU5cIilcclxufVxyXG5cclxuLyoqXHJcbiAqIOWIpOaWreS4gOS4qui3r+W+hOaYr+WQpuS4uiBPZmZpY2Ug5Li05pe25paH5Lu255qE6Lev5b6E77yI5paH5Lu25ZCN5LulIH4kIOW8gOWktO+8iVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzT2ZmaWNlVGVtcFBhdGgocDogc3RyaW5nKSB7XHJcbiAgICBpZiAoIXApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICAgIHJldHVybiBnZXRGaWxlTmFtZShwKS5zdGFydHNXaXRoKFwifiRcIilcclxufVxyXG4iXX0=