"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getFileName = getFileName;
exports.getFileNameWithoutExt = getFileNameWithoutExt;
exports.getExt = getExt;
exports.getExtWithoutDot = getExtWithoutDot;
exports.isSystemRecyclePath = isSystemRecyclePath;
exports.isOfficeTempPath = isOfficeTempPath;
exports.convertPathToFileUrl = convertPathToFileUrl;
exports.getPathRootName = getPathRootName;

/**
 * 获取文件名（包含扩展名），如：c:\1\2\3.txt => 3.txt
 */
function getFileName(path) {
  if (!path) {
    return "";
  }

  var str = path.replace(/\//g, "\\");
  var splitIndex = str.lastIndexOf("\\");

  if (splitIndex < 0) {
    return path.trim();
  }

  return str.substr(splitIndex + 1).trim();
}
/**
 * 获取文件名（不包含扩展名），如：c:\1\2\3.txt => 3
 */


function getFileNameWithoutExt(path) {
  var fileName = getFileName(path);

  if (!fileName) {
    return "";
  }

  var dotIndex = fileName.lastIndexOf(".");

  if (dotIndex < 0) {
    return fileName;
  }

  return fileName.substr(0, dotIndex);
}
/**
 * 获取扩展名（包含点）
 */


function getExt(path) {
  var fileName = getFileName(path);

  if (!fileName) {
    return "";
  }

  var dotIndex = fileName.lastIndexOf(".");

  if (dotIndex < 0) {
    return "";
  }

  return fileName.substr(dotIndex);
}
/**
 * 获取扩展名（不包含点）
 */


function getExtWithoutDot(path) {
  var fileName = getFileName(path);

  if (!fileName) {
    return "";
  }

  var dotIndex = fileName.lastIndexOf(".");

  if (dotIndex < 0) {
    return "";
  }

  return fileName.substr(dotIndex + 1);
}
/**
 * 判断一个路径是否为系统回收站的路径
 */


function isSystemRecyclePath(p) {
  if (!p) {
    return false;
  }

  return p.toUpperCase().includes("$RECYCLE.BIN");
}
/**
 * 判断一个路径是否为 Office 临时文件的路径（文件名以 ~$ 开头）
 */


function isOfficeTempPath(p) {
  if (!p) {
    return false;
  }

  return getFileName(p).startsWith("~$");
}
/**
 * 将物理绝对路径转换为 file 协议的 url
 */


function convertPathToFileUrl(p) {
  if (!p) {
    return "";
  }

  return "file://".concat(p.replaceAll("\\", "/").trim());
}
/**
 * 获取路径中的根名称，如：C:\a\b -> C，\\TEST-PC\a\b  -> TEST-PC
 */


function getPathRootName(p) {
  if (!p) {
    return "";
  }

  var reg = /^.+?:/;

  if (reg.test(p)) {
    var mts = p.match(reg);

    if (mts !== null && mts !== void 0 && mts.length) {
      return mts[0].replaceAll(":", "");
    }
  }

  reg = /^\\\\.+?\\/;

  if (reg.test(p)) {
    var _mts = p.match(reg);

    if (_mts !== null && _mts !== void 0 && _mts.length) {
      return _mts[0].replaceAll("\\", "");
    }
  }

  return "";
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9maWxlL3BhdGgudHMiXSwibmFtZXMiOlsiZ2V0RmlsZU5hbWUiLCJwYXRoIiwic3RyIiwicmVwbGFjZSIsInNwbGl0SW5kZXgiLCJsYXN0SW5kZXhPZiIsInRyaW0iLCJzdWJzdHIiLCJnZXRGaWxlTmFtZVdpdGhvdXRFeHQiLCJmaWxlTmFtZSIsImRvdEluZGV4IiwiZ2V0RXh0IiwiZ2V0RXh0V2l0aG91dERvdCIsImlzU3lzdGVtUmVjeWNsZVBhdGgiLCJwIiwidG9VcHBlckNhc2UiLCJpbmNsdWRlcyIsImlzT2ZmaWNlVGVtcFBhdGgiLCJzdGFydHNXaXRoIiwiY29udmVydFBhdGhUb0ZpbGVVcmwiLCJyZXBsYWNlQWxsIiwiZ2V0UGF0aFJvb3ROYW1lIiwicmVnIiwidGVzdCIsIm10cyIsIm1hdGNoIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNPLFNBQVNBLFdBQVQsQ0FBcUJDLElBQXJCLEVBQTJDO0FBQzlDLE1BQUksQ0FBQ0EsSUFBTCxFQUFXO0FBQ1AsV0FBTyxFQUFQO0FBQ0g7O0FBQ0QsTUFBTUMsR0FBRyxHQUFHRCxJQUFJLENBQUNFLE9BQUwsQ0FBYSxLQUFiLEVBQW9CLElBQXBCLENBQVo7QUFDQSxNQUFNQyxVQUFVLEdBQUdGLEdBQUcsQ0FBQ0csV0FBSixDQUFnQixJQUFoQixDQUFuQjs7QUFDQSxNQUFJRCxVQUFVLEdBQUcsQ0FBakIsRUFBb0I7QUFDaEIsV0FBT0gsSUFBSSxDQUFDSyxJQUFMLEVBQVA7QUFDSDs7QUFDRCxTQUFPSixHQUFHLENBQUNLLE1BQUosQ0FBV0gsVUFBVSxHQUFHLENBQXhCLEVBQTJCRSxJQUEzQixFQUFQO0FBQ0g7QUFFRDtBQUNBO0FBQ0E7OztBQUNPLFNBQVNFLHFCQUFULENBQStCUCxJQUEvQixFQUFxRDtBQUN4RCxNQUFNUSxRQUFRLEdBQUdULFdBQVcsQ0FBQ0MsSUFBRCxDQUE1Qjs7QUFDQSxNQUFJLENBQUNRLFFBQUwsRUFB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S0FBRixDQUFRSCxHQUFSLENBQVo7O0FBQ0EsUUFBSUUsSUFBSixhQUFJQSxJQUFKLGVBQUlBLElBQUcsQ0FBRUUsTUFBVCxFQUFpQjtBQUNiLGFBQU9GLElBQUcsQ0FBQyxDQUFELENBQUgsQ0FBT0osVUFBUCxDQUFrQixJQUFsQixFQUF3QixFQUF4QixDQUFQO0FBQ0g7QUFDSjs7QUFDRCxTQUFPLEVBQVA7QUFDSCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDojrflj5bmlofku7blkI3vvIjljIXlkKvmianlsZXlkI3vvInvvIzlpoLvvJpjOlxcMVxcMlxcMy50eHQgPT4gMy50eHRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWxlTmFtZShwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKCFwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCJcclxuICAgIH1cclxuICAgIGNvbnN0IHN0ciA9IHBhdGgucmVwbGFjZSgvXFwvL2csIFwiXFxcXFwiKVxyXG4gICAgY29uc3Qgc3BsaXRJbmRleCA9IHN0ci5sYXN0SW5kZXhPZihcIlxcXFxcIilcclxuICAgIGlmIChzcGxpdEluZGV4IDwgMCkge1xyXG4gICAgICAgIHJldHVybiBwYXRoLnRyaW0oKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN0ci5zdWJzdHIoc3BsaXRJbmRleCArIDEpLnRyaW0oKVxyXG59XHJcblxyXG4vKipcclxuICog6I635Y+W5paH5Lu25ZCN77yI5LiN5YyF5ZCr5omp5bGV5ZCN77yJ77yM5aaC77yaYzpcXDFcXDJcXDMudHh0ID0+IDNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWxlTmFtZVdpdGhvdXRFeHQocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gZ2V0RmlsZU5hbWUocGF0aClcclxuICAgIGlmICghZmlsZU5hbWUpIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG4gICAgY29uc3QgZG90SW5kZXggPSBmaWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIilcclxuICAgIGlmIChkb3RJbmRleCA8IDApIHtcclxuICAgICAgICByZXR1cm4gZmlsZU5hbWVcclxuICAgIH1cclxuICAgIHJldHVybiBmaWxlTmFtZS5zdWJzdHIoMCwgZG90SW5kZXgpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDojrflj5bmianlsZXlkI3vvIjljIXlkKvngrnvvIlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFeHQocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gZ2V0RmlsZU5hbWUocGF0aClcclxuICAgIGlmICghZmlsZU5hbWUpIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG4gICAgY29uc3QgZG90SW5kZXggPSBmaWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIilcclxuICAgIGlmIChkb3RJbmRleCA8IDApIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpbGVOYW1lLnN1YnN0cihkb3RJbmRleClcclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPluaJqeWxleWQje+8iOS4jeWMheWQq+eCue+8iVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEV4dFdpdGhvdXREb3QocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gZ2V0RmlsZU5hbWUocGF0aClcclxuICAgIGlmICghZmlsZU5hbWUpIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG4gICAgY29uc3QgZG90SW5kZXggPSBmaWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIilcclxuICAgIGlmIChkb3RJbmRleCA8IDApIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpbGVOYW1lLnN1YnN0cihkb3RJbmRleCArIDEpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDliKTmlq3kuIDkuKrot6/lvoTmmK/lkKbkuLrns7vnu5/lm57mlLbnq5nnmoTot6/lvoRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1N5c3RlbVJlY3ljbGVQYXRoKHA6IHN0cmluZykge1xyXG4gICAgaWYgKCFwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gcC50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKFwiJFJFQ1lDTEUuQklOXCIpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDliKTmlq3kuIDkuKrot6/lvoTmmK/lkKbkuLogT2ZmaWNlIOS4tOaXtuaWh+S7tueahOi3r+W+hO+8iOaWh+S7tuWQjeS7pSB+JCDlvIDlpLTvvIlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc09mZmljZVRlbXBQYXRoKHA6IHN0cmluZykge1xyXG4gICAgaWYgKCFwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gZ2V0RmlsZU5hbWUocCkuc3RhcnRzV2l0aChcIn4kXCIpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlsIbniannkIbnu53lr7not6/lvoTovazmjaLkuLogZmlsZSDljY/orq7nmoQgdXJsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29udmVydFBhdGhUb0ZpbGVVcmwocDogc3RyaW5nKSB7XHJcbiAgICBpZiAoIXApIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGBmaWxlOi8vJHtwLnJlcGxhY2VBbGwoXCJcXFxcXCIsIFwiL1wiKS50cmltKCl9YFxyXG59XHJcblxyXG4vKipcclxuICog6I635Y+W6Lev5b6E5Lit55qE5qC55ZCN56ew77yM5aaC77yaQzpcXGFcXGIgLT4gQ++8jFxcXFxURVNULVBDXFxhXFxiICAtPiBURVNULVBDXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGF0aFJvb3ROYW1lKHA6IHN0cmluZykge1xyXG4gICAgaWYgKCFwKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCJcclxuICAgIH1cclxuICAgIGxldCByZWcgPSAvXi4rPzovXHJcbiAgICBpZiAocmVnLnRlc3QocCkpIHtcclxuICAgICAgICBjb25zdCBtdHMgPSBwLm1hdGNoKHJlZylcclxuICAgICAgICBpZiAobXRzPy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG10c1swXS5yZXBsYWNlQWxsKFwiOlwiLCBcIlwiKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJlZyA9IC9eXFxcXFxcXFwuKz9cXFxcL1xyXG4gICAgaWYgKHJlZy50ZXN0KHApKSB7XHJcbiAgICAgICAgY29uc3QgbXRzID0gcC5tYXRjaChyZWcpXHJcbiAgICAgICAgaWYgKG10cz8ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtdHNbMF0ucmVwbGFjZUFsbChcIlxcXFxcIiwgXCJcIilcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gXCJcIlxyXG59XHJcbiJdfQ==